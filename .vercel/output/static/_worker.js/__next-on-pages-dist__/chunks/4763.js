var nt=(st,_e,w)=>{"use strict";let I;function Me(d){return new TextEncoder().encode(d).buffer.byteLength}w.d(_e,{d:()=>tt});var O=w(9737),de=w(7334),E=w(1987),Le=w(1981),te=w(8478);function ue(d){return d===te.Jp.experimentalEdge||d===te.Jp.edge}var B=w(2142),A=w(8858);class ae{insert(e){this._insert(e.split("/").filter(Boolean),[],!1)}smoosh(){return this._smoosh()}_smoosh(e="/"){let t=[...this.children.keys()].sort();this.slugName!==null&&t.splice(t.indexOf("[]"),1),this.restSlugName!==null&&t.splice(t.indexOf("[...]"),1),this.optionalRestSlugName!==null&&t.splice(t.indexOf("[[...]]"),1);let a=t.map(s=>this.children.get(s)._smoosh(`${e}${s}/`)).reduce((s,r)=>[...s,...r],[]);if(this.slugName!==null&&a.push(...this.children.get("[]")._smoosh(`${e}[${this.slugName}]/`)),!this.placeholder){let s=e==="/"?"/":e.slice(0,-1);if(this.optionalRestSlugName!=null)throw Error(`You cannot define a route with the same specificity as a optional catch-all route ("${s}" and "${s}[[...${this.optionalRestSlugName}]]").`);a.unshift(s)}return this.restSlugName!==null&&a.push(...this.children.get("[...]")._smoosh(`${e}[...${this.restSlugName}]/`)),this.optionalRestSlugName!==null&&a.push(...this.children.get("[[...]]")._smoosh(`${e}[[...${this.optionalRestSlugName}]]/`)),a}_insert(e,t,a){if(e.length===0){this.placeholder=!1;return}if(a)throw Error("Catch-all must be the last part of the URL.");let s=e[0];if(s.startsWith("[")&&s.endsWith("]")){let n=function(l,o){if(l!==null&&l!==o)throw Error(`You cannot use different slug names for the same dynamic path ('${l}' !== '${o}').`);t.forEach(h=>{if(h===o)throw Error(`You cannot have the same slug name "${o}" repeat within a single dynamic path`);if(h.replace(/\W/g,"")===s.replace(/\W/g,""))throw Error(`You cannot have the slug names "${h}" and "${o}" differ only by non-word symbols within a single dynamic path`)}),t.push(o)},r=s.slice(1,-1),i=!1;if(r.startsWith("[")&&r.endsWith("]")&&(r=r.slice(1,-1),i=!0),r.startsWith("...")&&(r=r.substring(3),a=!0),r.startsWith("[")||r.endsWith("]"))throw Error(`Segment names may not start or end with extra brackets ('${r}').`);if(r.startsWith("."))throw Error(`Segment names may not start with erroneous periods ('${r}').`);if(a)if(i){if(this.restSlugName!=null)throw Error(`You cannot use both an required and optional catch-all route at the same level ("[...${this.restSlugName}]" and "${e[0]}" ).`);n(this.optionalRestSlugName,r),this.optionalRestSlugName=r,s="[[...]]"}else{if(this.optionalRestSlugName!=null)throw Error(`You cannot use both an optional and required catch-all route at the same level ("[[...${this.optionalRestSlugName}]]" and "${e[0]}").`);n(this.restSlugName,r),this.restSlugName=r,s="[...]"}else{if(i)throw Error(`Optional route parameters are not yet supported ("${e[0]}").`);n(this.slugName,r),this.slugName=r,s="[]"}}this.children.has(s)||this.children.set(s,new ae),this.children.get(s)._insert(e.slice(1),t,a)}constructor(){this.placeholder=!0,this.children=new Map,this.slugName=null,this.restSlugName=null,this.optionalRestSlugName=null}}function qe(d){let e=new ae;return d.forEach(t=>e.insert(t)),e.smoosh()}function ce(d){return function(){let e=d.cookie;if(!e)return{};let{parse:t}=w(738);return t(Array.isArray(e)?e.join(";"):e)}}function Oe(d,e){return{isManualRevalidate:d.headers["x-prerender-revalidate"]===e.previewModeId,revalidateOnlyGenerated:!!d.headers["x-prerender-revalidate-if-generated"]}}function Ee({req:d},e,t){let a={configurable:!0,enumerable:!0},s={...a,writable:!0};Object.defineProperty(d,e,{...a,get:()=>{let r=t();return Object.defineProperty(d,e,{...s,value:r}),r},set:r=>{Object.defineProperty(d,e,{...s,value:r})}})}Symbol("__next_preview_data"),Symbol("__prerender_bypass");var L=w(5130),pe=w(8849),W=w(5114),F=w(3066),k=w(4773),re=w(7826),fe=w(7924),ke=w(7447),me=w(5860);class De{context=new WeakMap;constructor({headers:e=[],fsRoutes:t=[],rewrites:a={beforeFiles:[],afterFiles:[],fallback:[]},redirects:s=[],catchAllRoute:r,catchAllMiddleware:i=[],dynamicRoutes:n=[],pageChecker:l,useFileSystemPublicRoutes:o,nextConfig:h}){this.nextConfig=h,this.headers=e,this.fsRoutes=[...t],this.rewrites=a,this.redirects=s,this.pageChecker=l,this.catchAllRoute=r,this.catchAllMiddleware=i,this.dynamicRoutes=n,this.useFileSystemPublicRoutes=o,this.compiledRoutes=this.compileRoutes(),this.needsRecompilation=!1}async checkPage(e,t){t=(0,k.h)(t,this.locales).pathname;let a=this.context.get(e);if(!a)throw Error("Invariant: request is not available inside the context, this is an internal error please open an issue.");if(a.pageChecks[t]!==void 0)return a.pageChecks[t];let s=await this.pageChecker(t);return a.pageChecks[t]=s,s}get locales(){var e;return((e=this.nextConfig.i18n)==null?void 0:e.locales)||[]}get basePath(){return this.nextConfig.basePath||""}setDynamicRoutes(e){this.dynamicRoutes=e,this.needsRecompilation=!0}setCatchallMiddleware(e){this.catchAllMiddleware=e,this.needsRecompilation=!0}addFsRoute(e){this.fsRoutes.unshift(e),this.needsRecompilation=!0}compileRoutes(){let[e]=this.catchAllMiddleware;return[...e?this.fsRoutes.filter(t=>t.name==="_next/data catchall").map(t=>({...t,name:"_next/data normalizing",check:!1})):[],...this.headers,...this.redirects,...this.useFileSystemPublicRoutes&&e?[e]:[],...this.rewrites.beforeFiles,...this.fsRoutes,...this.useFileSystemPublicRoutes?[{type:"route",name:"page checker",match:(0,W.B)("/:path*"),fn:async(t,a,s,r,i)=>{let n=(0,F.Q)(r.pathname||"/");return n&&await this.checkPage(t,n)?this.catchAllRoute.fn(t,a,s,r,i):{finished:!1}}}]:[],...this.rewrites.afterFiles,...this.rewrites.fallback.length?[{type:"route",name:"dynamic route/page check",match:(0,W.B)("/:path*"),fn:async(t,a,s,r,i)=>({finished:await this.checkFsRoutes(t,a,r,i)})},...this.rewrites.fallback]:[],...this.useFileSystemPublicRoutes?[this.catchAllRoute]:[]]}async checkFsRoutes(e,t,a,s){let r=a.pathname,i=(0,fe.n)(r,this.basePath);for(let l of this.fsRoutes){let o=l.match(i);if(o){a.pathname=i;let{finished:h}=await l.fn(e,t,o,a);if(h)return!0;a.pathname=r}}let n=await this.checkPage(e,i);if(!n){let l=(0,k.h)(i,this.locales).pathname;for(let o of this.dynamicRoutes)o.match(l)&&(n=!0)}if(n){let l=this.catchAllRoute.match(a.pathname);if(!l)throw Error("Invariant: could not match params, this is an internal error please open an issue.");a.pathname=i,a.query._nextBubbleNoFallback="1";let{finished:o}=await this.catchAllRoute.fn(e,t,l,a,s);return o}return!1}async execute(e,t,a,s){if(this.needsRecompilation&&(this.compiledRoutes=this.compileRoutes(),this.needsRecompilation=!1),this.context.has(e))throw Error(`Invariant: request has already been processed: ${e.url}, this is an internal error please open an issue.`);this.context.set(e,{pageChecks:{}});try{let i={...a,query:{...a.query}};for(let n of this.compiledRoutes){var r;if(s&&n.type!=="rewrite")continue;let l=i.pathname,o=(0,me.a)(l,{nextConfig:this.nextConfig,parseData:!1});if(o.locale&&!n.matchesLocaleAPIRoutes&&(0,pe.Q)(o.pathname))continue;(0,L.OX)(e,"_nextHadBasePath")&&(o.basePath=this.basePath);let h=o.basePath;n.matchesBasePath||(o.basePath=""),n.matchesLocale&&i.query.__nextLocale&&!o.locale&&(o.locale=i.query.__nextLocale),!n.matchesLocale&&o.locale===((r=this.nextConfig.i18n)==null?void 0:r.defaultLocale)&&o.locale&&(o.locale=void 0),n.matchesTrailingSlash&&(0,L.OX)(e,"__nextHadTrailingSlash")&&(o.trailingSlash=!0);let p=(0,ke.R)({ignorePrefix:!0,...o}),u=n.match(p);if((n.has||n.missing)&&u){let f=(0,re.H4)(e,i.query,n.has,n.missing);f?Object.assign(u,f):u=!1}if((!u||!this.basePath||n.matchesBasePath||(0,L.OX)(e,"_nextDidRewrite")||h)&&u){let f=n.name==="_next/data normalizing";f&&(0,L.kL)(e,"_nextDataNormalizing",!0),i.pathname=p;let c=await n.fn(e,t,u,i,s);if(f&&(0,L.kL)(e,"_nextDataNormalizing",!1),c.finished||(c.pathname?i.pathname=c.pathname:i.pathname=l,c.query&&(i.query={...(0,L.f0)(i.query),...c.query}),n.check&&await this.checkFsRoutes(e,t,i)))return!0}}return!1}finally{this.context.delete(e)}}}function ge(d,e){if(e.private||e.stateful)(e.private||!d.hasHeader("Cache-Control"))&&d.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");else if(typeof e.revalidate=="number"){if(e.revalidate<1)throw Error(`invariant: invalid Cache-Control duration provided: ${e.revalidate} < 1`);d.setHeader("Cache-Control",`s-maxage=${e.revalidate}, stale-while-revalidate`)}else e.revalidate===!1&&d.setHeader("Cache-Control","s-maxage=31536000, stale-while-revalidate")}function Ae(d){return B.Xn.includes(d)}function se(d){return/Googlebot|Mediapartners-Google|AdsBot-Google|googleweblight|Storebot-Google|Google-PageRenderer|Bingbot|BingPreview|Slurp|DuckDuckBot|baiduspider|yandex|sogou|LinkedInBot|bitlybot|tumblr|vkShare|quora link preview|facebookexternalhit|facebookcatalog|Twitterbot|applebot|redditbot|Slackbot|Discordbot|WhatsApp|SkypeUriPreview|ia_archiver/i.test(d)}var J=w(4137),ie=w(8402);I=w(844).Z;let $e={wait:I.cyan("wait")+"  -",error:I.red("error")+" -",warn:I.yellow("warn")+"  -",ready:I.green("ready")+" -",info:I.cyan("info")+"  -",event:I.magenta("event")+" -",trace:I.magenta("trace")+" -"};function Te(...d){console.warn($e.warn,...d)}var K=w(3208);function He(d,e){return d.replace(RegExp(`([/#?]${e?"|%(2f|23|3f)":""})`,"gi"),t=>encodeURIComponent(t))}var ne=w(8464),oe=w(995);function Ie(d,e,t){let a=new Map,s=d.replace(/[ \t]/g,"");if(e){let h=0;for(let p of e){let u=p.toLowerCase();if(a.set(u,{orig:p,pos:h++}),t.prefixMatch){let f=u.split("-");for(;f.pop(),f.length>0;){let c=f.join("-");a.has(c)||a.set(c,{orig:p,pos:h++})}}}}let r=s.split(","),i=[],n=new Set;for(let h=0;h<r.length;++h){let p=r[h];if(!p)continue;let u=p.split(";");if(u.length>2)throw Error(`Invalid ${t.type} header`);let f=u[0].toLowerCase();if(!f)throw Error(`Invalid ${t.type} header`);let c={token:f,pos:h,q:1};if(e&&a.has(f)&&(c.pref=a.get(f).pos),n.add(c.token),u.length===2){let m=u[1],[v,C]=m.split("=");if(!C||v!=="q"&&v!=="Q")throw Error(`Invalid ${t.type} header`);let g=parseFloat(C);if(g===0)continue;Number.isFinite(g)&&g<=1&&g>=.001&&(c.q=g)}i.push(c)}i.sort((h,p)=>p.q!==h.q?p.q-h.q:p.pref!==h.pref?h.pref===void 0?1:p.pref===void 0?-1:h.pref-p.pref:h.pos-p.pos);let l=i.map(h=>h.token);if(!e||!e.length)return l;let o=[];for(let h of l)if(h==="*")for(let[p,u]of a)n.has(p)||o.push(u.orig);else{let p=h.toLowerCase();a.has(p)&&o.push(a.get(p).orig)}return o}function Ne(d="",e){return Ie(d,e,{type:"accept-language",prefixMatch:!0})[0]||""}function je(d,e){let{NEXT_LOCALE:t}=d.cookies||{};return t?e.find(a=>t.toLowerCase()===a.toLowerCase()):void 0}var Fe=w(738),it=w.n(Fe),U=w(4678);function ye(d,e,t,a,s){if(a&&e&&s){let r=(0,E.parse)(d.url,!0);for(let i of(delete r.search,t||Object.keys(s.groups)))delete r.query[i];d.url=(0,E.format)(r)}}function ve(d,e,t){if(!t)return d;for(let a of Object.keys(t.groups)){let{optional:s,repeat:r}=t.groups[a],i=`[${r?"...":""}${a}]`;s&&(i=`[${i}]`);let n=d.indexOf(i);if(n>-1){let l,o=e[a];l=Array.isArray(o)?o.map(h=>h&&encodeURIComponent(h)).join("/"):o?encodeURIComponent(o):"",d=d.slice(0,n)+l+d.slice(n+i.length)}}return d}function Be({page:d,i18n:e,basePath:t,rewrites:a,pageIsDynamic:s,trailingSlash:r}){let i,n,l;return s&&(i=(0,ne.JV)(d),l=(n=(0,oe.t)(i))(d)),{handleLocale:function(o,h,p,u,f){let c,m;if(!e)return;let v=p.pathname||"/",C=e.defaultLocale,g=je(o,e.locales);try{c=e.localeDetection!==!1?Ne(o.headers["accept-language"],e.locales):g}catch{c=g}let{host:x}=o.headers||{},y=x&&x.split(":")[0].toLowerCase(),b=(0,K.D)(e.domains,y);b&&(g=C=b.defaultLocale,(0,L.kL)(o,"__nextIsLocaleDomain",!0)),g=g||c;let R=(0,k.h)(v,e.locales);if(u=(0,k.h)(u,e.locales).pathname,R.detectedLocale&&(g=R.detectedLocale,o.url=(0,E.format)({...p,pathname:R.pathname}),(0,L.kL)(o,"__nextStrippedLocale",!0),p.pathname=R.pathname),b){let S=R.detectedLocale?g:c,_=(0,K.D)(e.domains,void 0,S);_&&_.domain!==b.domain&&(m=`http${_.http?"":"s"}://${_.domain}/${S===_.defaultLocale?"":S}`)}let q=(0,ie.s)(v),$=!g||g.toLowerCase()===C.toLowerCase();if(g=g||e.defaultLocale,!f&&!o.headers["x-vercel-id"]&&e.localeDetection!==!1&&(m||!$&&q==="/")){h.setHeader("Location",(0,E.format)({...p,pathname:m||`${t}/${g}`})),h.statusCode=B.o3,h.end();return}return g=R.detectedLocale||b&&b.defaultLocale||C,{defaultLocale:C,detectedLocale:g,routeNoAssetPath:u}},handleRewrites:function(o,h){let p={},u=h.pathname,f=c=>{let m=(0,W.B)(c.source+(r?"(/)?":""),{removeUnnamedParams:!0,strict:!0}),v=m(h.pathname);if((c.has||c.missing)&&v){let C=(0,re.H4)(o,h.query,c.has,c.missing);C?Object.assign(v,C):v=!1}if(v){let{parsedDestination:C,destQuery:g}=(0,re.j8)({appendParamsToQuery:!0,destination:c.destination,params:v,query:h.query});if(C.protocol)return!0;if(Object.assign(p,g,v),Object.assign(h.query,C.query),delete C.query,Object.assign(h,C),u=h.pathname,t&&(u=u.replace(RegExp(`^${t}`),"")||"/"),e){let x=(0,k.h)(u,e.locales);u=x.pathname,h.query.nextInternalLocale=x.detectedLocale||v.nextInternalLocale}if(u===d)return!0;if(s&&n){let x=n(u);if(x)return h.query={...h.query,...x},!0}}return!1};for(let c of a.beforeFiles||[])f(c);if(u!==d){let c=!1;for(let m of a.afterFiles||[])if(c=f(m))break;if(!c&&!(()=>{let m=(0,F.Q)(u||"");return m===(0,F.Q)(d)||n?.(m)})()){for(let m of a.fallback||[])if(c=f(m))break}}return p},handleBasePath:function(o,h){o.url=o.url.replace(RegExp(`^${t}`),"")||"/",h.pathname=h.pathname.replace(RegExp(`^${t}`),"")||"/"},defaultRouteRegex:i,dynamicRouteMatcher:n,defaultRouteMatches:l,getParamsFromRouteMatches:function(o,h,p){return(0,oe.t)(function(){let{groups:u,routeKeys:f}=i;return{re:{exec:c=>{let m=(0,de.parse)(c),v=e&&p&&m[1]===p,C=Object.keys(f||{}),g=x=>{if(e){let y=Array.isArray(x),b=y?x[0]:x;if(typeof b=="string"&&e.locales.some(R=>R.toLowerCase()===b.toLowerCase()&&(p=R,h.locale=p,!0)))return y&&x.splice(0,1),!y||x.length===0}return!1};return C.every(x=>m[x])?C.reduce((x,y)=>{let b=f?.[y];return b&&!g(m[y])&&(x[u[b].pos]=m[y]),x},{}):Object.keys(m).reduce((x,y)=>{if(!g(m[y])){let b=y;return v&&(b=parseInt(y,10)-1+""),Object.assign(x,{[b]:m[y]})}return x},{})}},groups:u}}())(o.headers["x-now-route-matches"])},normalizeDynamicRouteParams:function(o,h){let p=!0;return i?(o=Object.keys(i.groups).reduce((u,f)=>{let c=o[f];typeof c=="string"&&(c=(0,U.W)(c,!0)),Array.isArray(c)&&(c=c.map(g=>(typeof g=="string"&&(g=(0,U.W)(g,!0)),g)));let m=l[f],v=i.groups[f].optional;return((Array.isArray(m)?m.some(g=>Array.isArray(c)?c.some(x=>x.includes(g)):c?.includes(g)):c?.includes(m))||c===void 0&&!(v&&h))&&(p=!1),v&&(!c||Array.isArray(c)&&c.length===1&&(c[0]==="index"||c[0]===`[[...${f}]]`))&&(c=void 0,delete o[f]),c&&typeof c=="string"&&i.groups[f].repeat&&(c=c.split("/")),c&&(u[f]=c),u},{}),{params:o,hasValidParams:p}):{params:o,hasValidParams:!1}},normalizeVercelUrl:(o,h,p)=>ye(o,h,p,s,i),interpolateDynamicPath:(o,h)=>ve(o,h,i)}}var X=w(9136),We=w(6936),Ue=w(7636),G=w(7136);class Y extends Error{}class xe extends Error{constructor(e){super(),this.innerError=e}}class ze{constructor(e){var t,a;let{dir:s=".",quiet:r=!1,conf:i,dev:n=!1,minimalMode:l=!1,customServer:o=!0,hostname:h,port:p}=e;this.serverOptions=e,this.dir=s,this.quiet=r,this.loadEnvConfig({dev:n}),this.nextConfig=i,this.hostname=h,this.port=p,this.distDir=this.nextConfig.distDir,this.publicDir=this.getPublicDir(),this.hasStaticDir=!l&&this.getHasStaticDir();let{serverRuntimeConfig:u={},publicRuntimeConfig:f,assetPrefix:c,generateEtags:m}=this.nextConfig;this.buildId=this.getBuildId(),this.minimalMode=l||!!process.env.NEXT_PRIVATE_MINIMAL_MODE,this.hasAppDir=!!this.nextConfig.experimental.appDir&&this.getHasAppDir(n);let v=this.hasAppDir;this.serverComponentManifest=v?this.getServerComponentManifest():void 0,this.serverCSSManifest=v?this.getServerCSSManifest():void 0,this.fontLoaderManifest=this.nextConfig.experimental.fontLoaders?this.getFontLoaderManifest():void 0,this.renderOpts={poweredByHeader:this.nextConfig.poweredByHeader,canonicalBase:this.nextConfig.amp.canonicalBase||"",buildId:this.buildId,generateEtags:m,previewProps:this.getPreviewProps(),customServer:o===!0||void 0,ampOptimizerConfig:(t=this.nextConfig.experimental.amp)==null?void 0:t.optimizer,basePath:this.nextConfig.basePath,images:this.nextConfig.images,optimizeFonts:this.nextConfig.optimizeFonts,fontManifest:this.nextConfig.optimizeFonts&&!n?this.getFontManifest():void 0,optimizeCss:this.nextConfig.experimental.optimizeCss,nextScriptWorkers:this.nextConfig.experimental.nextScriptWorkers,disableOptimizedLoading:!!this.nextConfig.experimental.runtime||this.nextConfig.experimental.disableOptimizedLoading,domainLocales:(a=this.nextConfig.i18n)==null?void 0:a.domains,distDir:this.distDir,runtime:this.nextConfig.experimental.runtime,serverComponents:v,crossOrigin:this.nextConfig.crossOrigin?this.nextConfig.crossOrigin:void 0,largePageDataBytes:this.nextConfig.experimental.largePageDataBytes},Object.keys(f).length>0&&(this.renderOpts.runtimeConfig=f),this.pagesManifest=this.getPagesManifest(),this.appPathsManifest=this.getAppPathsManifest(),this.customRoutes=this.getCustomRoutes(),this.router=new De(this.generateRoutes()),this.setAssetPrefix(c),this.responseCache=this.getResponseCache({dev:n})}logError(e){this.quiet||console.error(e)}async handleRequest(e,t,a){try{var s,r,i;let n=t.originalResponse||t,l=n.setHeader.bind(n);n.setHeader=(m,v)=>{if(m.toLowerCase()==="set-cookie"){let C=(0,L.OX)(e,"_nextMiddlewareCookie");C&&Array.isArray(v)&&v.every((g,x)=>g===C[x])||(v=[...C||[],...typeof v=="string"?[v]:Array.isArray(v)?v:[]])}return l(m,v)};let o=(e.url||"").split("?"),h=o[0];if(h?.match(/(\\|\/\/)/)){let m=(0,O.U3)(e.url);t.redirect(m,308).body(m).send();return}Ee({req:e},"cookies",ce(e.headers)),a&&typeof a=="object"||(a=(0,E.parse)(e.url,!0)),typeof a.query=="string"&&(a.query=(0,de.parse)(a.query)),this.minimalMode&&e.url.endsWith(".rsc")&&(a.query.__nextDataReq="1"),e.url=(0,U.W)(e.url,this.hasAppDir),a.pathname=(0,U.W)(a.pathname||"",this.hasAppDir),this.attachRequestMeta(e,a);let p=(0,K.D)((s=this.nextConfig.i18n)==null?void 0:s.domains,(0,We.F)(a,e.headers)),u=p?.defaultLocale||((r=this.nextConfig.i18n)==null?void 0:r.defaultLocale),f=(0,Ue.e)(e.url.replace(/^\/+/,"/")),c=(0,me.a)(f.pathname,{nextConfig:this.nextConfig});if(f.pathname=c.pathname,c.basePath&&(e.url=(0,fe.n)(e.url,this.nextConfig.basePath),(0,L.kL)(e,"_nextHadBasePath",!0)),this.minimalMode&&typeof e.headers["x-matched-path"]=="string")try{this.hasAppDir&&(e.url.match(/^\/index($|\?)/)&&(e.url=e.url.replace(/^\/index/,"/")),a.pathname=a.pathname==="/index"?"/":a.pathname);let m=(0,U.W)(new URL(e.headers["x-matched-path"],"http://localhost").pathname,this.hasAppDir),v=new URL(e.url,"http://localhost").pathname;v.startsWith("/_next/data/")&&(a.query.__nextDataReq="1");let C=this.stripNextDataPath(v);if(m=this.stripNextDataPath(m,!1),this.nextConfig.i18n){let S=(0,k.h)(m,this.nextConfig.i18n.locales);m=S.pathname,S.detectedLocale&&(a.query.__nextLocale=S.detectedLocale)}let g=m=(0,ie.s)(m);if(!(0,A.$)(g)&&!await this.hasPage((0,F.Q)(g))){for(let S of this.dynamicRoutes||[])if(S.match(g)){g=S.page;break}}let x=(0,A.$)(g),y=Be({pageIsDynamic:x,page:g,i18n:this.nextConfig.i18n,basePath:this.nextConfig.basePath,rewrites:this.customRoutes.rewrites});u&&!c.locale&&(a.pathname=`/${u}${a.pathname}`);let b=a.pathname,R=y.handleRewrites(e,a),q=Object.keys(R),$=b!==a.pathname;if($&&((0,L.kL)(e,"_nextRewroteUrl",a.pathname),(0,L.kL)(e,"_nextDidRewrite",!0)),x){let S={},_=y.normalizeDynamicRouteParams(a.query);if(!_.hasValidParams&&x&&!(0,A.$)(C)){let T=y.dynamicRouteMatcher==null?void 0:y.dynamicRouteMatcher(C);T&&(y.normalizeDynamicRouteParams(T),Object.assign(_.params,T),_.hasValidParams=!0)}if(_.hasValidParams&&(S=_.params),e.headers["x-now-route-matches"]&&(0,A.$)(m)&&!_.hasValidParams){let T={},N=y.getParamsFromRouteMatches(e,T,a.query.__nextLocale||"");T.locale&&(a.query.__nextLocale=T.locale),(_=y.normalizeDynamicRouteParams(N,!0)).hasValidParams&&(S=_.params)}x&&y.defaultRouteMatches&&C===g&&!_.hasValidParams&&!y.normalizeDynamicRouteParams({...S},!0).hasValidParams&&(S=y.defaultRouteMatches),S&&(m=y.interpolateDynamicPath(g,S),e.url=y.interpolateDynamicPath(e.url,S)),Object.assign(a.query,S)}(x||$)&&y.normalizeVercelUrl(e,!0,[...q,...Object.keys(((i=y.defaultRouteRegex)==null?void 0:i.groups)||{})]),a.pathname=`${this.nextConfig.basePath||""}${m==="/"&&this.nextConfig.basePath?"":m}`,f.pathname=a.pathname}catch(m){if(m instanceof O._9||m instanceof O.KM)return t.statusCode=400,this.renderError(null,e,t,"/_error",{});throw m}return(0,L.kL)(e,"__nextHadTrailingSlash",c.trailingSlash),(0,L.kL)(e,"__nextIsLocaleDomain",Boolean(p)),a.query.__nextDefaultLocale=u,c.locale&&(e.url=(0,E.format)(f),(0,L.kL)(e,"__nextStrippedLocale",!0)),(!this.minimalMode||!a.query.__nextLocale)&&(c.locale||u)&&(a.query.__nextLocale=c.locale||u),t.statusCode=200,await this.run(e,t,a)}catch(n){if(n&&typeof n=="object"&&n.code==="ERR_INVALID_URL"||n instanceof O._9||n instanceof O.KM)return t.statusCode=400,this.renderError(null,e,t,"/_error",{});if(this.minimalMode||this.renderOpts.dev)throw n;this.logError((0,X.S)(n)),t.statusCode=500,t.body("Internal Server Error").send()}}getRequestHandler(){return this.handleRequest.bind(this)}async handleUpgrade(e,t,a){}setAssetPrefix(e){this.renderOpts.assetPrefix=e?e.replace(/\/$/,""):""}async prepare(){}async close(){}getPreviewProps(){return this.getPrerenderManifest().preview}async _beforeCatchAllRender(e,t,a,s){return!1}getDynamicRoutes(){let e=new Set;return qe([...Object.keys(this.appPathRoutes||{}),...Object.keys(this.pagesManifest)].map(t=>{var a;return(0,k.h)(t,(a=this.nextConfig.i18n)==null?void 0:a.locales).pathname})).map(t=>e.has(t)||!(0,A.$)(t)?null:(e.add(t),{page:t,match:(0,oe.t)((0,ne.vG)(t))})).filter(t=>Boolean(t))}getAppPathRoutes(){let e={};return Object.keys(this.appPathsManifest||{}).forEach(t=>{let a=(0,U.w)(t)||"/";e[a]||(e[a]=[]),e[a].push(t)}),e}async run(e,t,a){this.handleCompression(e,t);try{if(await this.router.execute(e,t,a))return}catch(s){if(s instanceof O._9||s instanceof O.KM)return t.statusCode=400,this.renderError(null,e,t,"/_error",{});throw s}await this.render404(e,t,a)}async pipe(e,t){let a=se(t.req.headers["user-agent"]||""),s={...t,renderOpts:{...this.renderOpts,supportsDynamicHTML:!a,isBot:!!a}},r=await e(s);if(r===null)return;let{req:i,res:n}=s,{body:l,type:o,revalidateOptions:h}=r;if(!n.sent){let{generateEtags:p,poweredByHeader:u,dev:f}=this.renderOpts;return f&&n.setHeader("Cache-Control","no-store, must-revalidate"),this.sendRenderResult(i,n,{result:l,type:o,generateEtags:p,poweredByHeader:u,options:h})}}async getStaticHTML(e,t){let a=await e({...t,renderOpts:{...this.renderOpts,supportsDynamicHTML:!1}});return a===null?null:a.body.toUnchunkedString()}async render(e,t,a,s={},r,i=!1){var n;return a.startsWith("/")||console.warn(`Cannot render page with path "${a}", did you mean "/${a}"?. See more info here: https://nextjs.org/docs/messages/render-no-starting-slash`),this.renderOpts.customServer&&a==="/index"&&!await this.hasPage("/index")&&(a="/"),!i&&!this.minimalMode&&!s.__nextDataReq&&(((n=e.url)==null?void 0:n.match(/^\/_next\//))||this.hasStaticDir&&e.url.match(/^\/static\//))?this.handleRequest(e,t,r):(this.renderOpts.customServer&&this.handleCompression(e,t),Ae(a)?this.render404(e,t,r):this.pipe(l=>this.renderToResponse(l),{req:e,res:t,pathname:a,query:s}))}async getStaticPaths({pathname:e}){var t;let a=(t=this.getPrerenderManifest().dynamicRoutes[e])==null?void 0:t.fallback;return{staticPaths:void 0,fallbackMode:typeof a=="string"?"static":a===null?"blocking":a}}async renderToResponseWithComponents({req:e,res:t,pathname:a,renderOpts:s},{components:r,query:i}){var n,l,o,h,p;let u,f,c=a==="/404",m=a==="/500",v=r.isAppPath,C=!!r.getServerSideProps,g=!!r.getStaticPaths,x=!!((n=r.Component)!=null&&n.getInitialProps),y=!!r.getStaticProps,b=(0,E.parse)(e.url||"").pathname||"/",R=(0,L.OX)(e,"_nextRewroteUrl")||b;if(v){let M=await this.getStaticPaths({pathname:a,originalAppPath:r.pathname});u=M.staticPaths,f=M.fallbackMode;let P=f!==void 0;if(P&&(g=!0),P||u?.includes(R))y=!0;else if(!this.renderOpts.dev){let D=this.getPrerenderManifest();y=y||!!D.routes[a==="/index"?"/":a]}}let q=!!(i.__nextDataReq||e.headers["x-nextjs-data"]&&this.serverOptions.webServerConfig)&&(y||C);if(!y&&e.headers["x-middleware-prefetch"])return t.setHeader("x-middleware-skip","1"),t.body("{}").send(),null;if(v&&(t.setHeader("vary",G.Am),y&&e.headers[G.i4.toLowerCase()]&&(this.minimalMode||(q=!0),!ue(s.runtime)||this.serverOptions.webServerConfig)))for(let M of G.vu)delete e.headers[M.toString().toLowerCase()];delete i.__nextDataReq,y&&this.minimalMode&&e.headers["x-matched-path"]&&e.url.startsWith("/_next/data")&&(e.url=this.stripNextDataPath(e.url)),e.headers["x-nextjs-data"]&&(!t.statusCode||t.statusCode===200)&&t.setHeader("x-nextjs-matched-path",`${i.__nextLocale?`/${i.__nextLocale}`:""}${a}`);let $=Boolean(this.serverComponentManifest&&e.headers[G.i4.toLowerCase()]);if(!c||q||$||(t.statusCode=404),B.Er.includes(a)&&(t.statusCode=parseInt(a.slice(1),10)),!c&&!m&&a!=="/_error"&&e.method!=="HEAD"&&e.method!=="GET"&&(typeof r.Component=="string"||y))return t.statusCode=405,t.setHeader("Allow",["GET","HEAD"]),await this.renderError(null,e,t,a),null;if(typeof r.Component=="string")return{type:"html",body:J.Z.fromStatic(r.Component)};if(i.amp||delete i.amp,s.supportsDynamicHTML===!0){let M=se(e.headers["user-agent"]||""),P=typeof((p=r.Document)==null?void 0:p.getInitialProps)!="function"||B.wU in r.Document;s.supportsDynamicHTML=!y&&!M&&!i.amp&&P,s.isBot=M}let S=y?(l=this.nextConfig.i18n)==null?void 0:l.defaultLocale:i.__nextDefaultLocale,_=i.__nextLocale,T=(o=this.nextConfig.i18n)==null?void 0:o.locales,N=!1,le=!1;y&&({isManualRevalidate:N,revalidateOnlyGenerated:le}=Oe(e,this.renderOpts.previewProps)),y&&this.minimalMode&&e.headers["x-matched-path"]&&(R=b),b=(0,F.Q)(b),R=(0,k.h)((0,F.Q)(R),(h=this.nextConfig.i18n)==null?void 0:h.locales).pathname,q&&(R=this.stripNextDataPath(R),b=this.stripNextDataPath(b));let j=!y||s.supportsDynamicHTML?null:`${_?`/${_}`:""}${(a==="/"||R==="/")&&_?"":R}${i.amp?".amp":""}`;(c||m)&&y&&(j=`${_?`/${_}`:""}${a}${i.amp?".amp":""}`),j&&(j=(j=j.split("/").map(M=>{try{M=He(decodeURIComponent(M),!0)}catch{throw new O._9("failed to decode param")}return M}).join("/"))==="/index"&&a==="/"?"/":j);let Ce=this.getIncrementalCache({requestHeaders:Object.assign({},e.headers)});this.nextConfig.experimental.fetchCache&&(!ue(s.runtime)||this.serverOptions.webServerConfig)&&delete e.headers[G.yR];let we=!1,at=async()=>{let M,P,D,Q,ee,he=(0,E.parse)(e.url||"",!0).query;s.params&&Object.keys(s.params).forEach(rt=>{delete he[rt]});let be=b!=="/"&&this.nextConfig.trailingSlash,Pe=(0,E.format)({pathname:`${R}${be?"/":""}`,query:he}),V={...r,...s,...v&&this.nextConfig.experimental.fetchCache?{incrementalCache:Ce,isRevalidate:this.minimalMode||we}:{},isDataReq:q,resolvedUrl:Pe,locale:_,locales:T,defaultLocale:S,resolvedAsPath:C||x?(0,E.format)({pathname:`${b}${be?"/":""}`,query:he}):Pe};(y||g)&&(V.supportsDynamicHTML=!1);let Se=await this.renderHTML(e,t,a,i,V);if(M=V.pageData,P=V.revalidate,D=V.isNotFound,Q=V.isRedirect,D)ee=null;else if(Q)ee={kind:"REDIRECT",props:M};else{if(!Se)return null;ee={kind:"PAGE",html:Se,pageData:M}}return{revalidate:P,value:ee}},Z=await this.responseCache.get(j,async(M,P)=>{if(this.renderOpts.dev,(0,A.$)(a),M||t.sent,P&&(we=!0),u||({staticPaths:u,fallbackMode:f}=g?await this.getStaticPaths({pathname:a}):{staticPaths:void 0,fallbackMode:!1}),f==="static"&&se(e.headers["user-agent"]||"")&&(f="blocking"),N&&le&&!P&&!this.minimalMode)return await this.render404(e,t),null;N&&(f!==!1||P)&&(f="blocking");let D=await at();return D?{...D,revalidate:D.revalidate!==void 0?D.revalidate:1}:null},{incrementalCache:Ce,isManualRevalidate:N,isPrefetch:e.headers.purpose==="prefetch"});if(!Z){if(j&&!(N&&le))throw Error("invariant: cache entry required but not generated");return null}y&&!this.minimalMode&&t.setHeader("x-nextjs-cache",N?"REVALIDATED":Z.isMiss?"MISS":Z.isStale?"STALE":"HIT");let{revalidate:Re,value:H}=Z,z=Re===void 0||this.renderOpts.dev&&(!C||q)?void 0:{private:c&&H,stateful:!y,revalidate:Re};if(H){if(H.kind==="REDIRECT")return z&&ge(t,z),q?{type:"json",body:J.Z.fromStatic(JSON.stringify(H.props)),revalidateOptions:z}:(await(M=>{let P={destination:M.pageProps.__N_REDIRECT,statusCode:M.pageProps.__N_REDIRECT_STATUS,basePath:M.pageProps.__N_REDIRECT_BASE_PATH},D=(0,Le.WW)(P),{basePath:Q}=this.nextConfig;Q&&P.basePath!==!1&&P.destination.startsWith("/")&&(P.destination=`${Q}${P.destination}`),P.destination.startsWith("/")&&(P.destination=(0,O.U3)(P.destination)),t.redirect(P.destination,D).body(P.destination).send()})(H.props),null);if(H.kind!=="IMAGE")return{type:q?v?"rsc":"json":"html",body:q?J.Z.fromStatic(v?H.pageData:JSON.stringify(H.pageData)):H.html,revalidateOptions:z};throw Error("invariant SSG should not return an image cache value")}return z&&ge(t,z),q?(t.statusCode=404,t.body('{"notFound":true}').send(),null):(this.renderOpts.dev&&(i.__nextNotFoundSrcPage=a),await this.render404(e,t,{pathname:a,query:i},!1),null)}stripNextDataPath(e,t=!0){if(e.includes(this.buildId)){let a=e.substring(e.indexOf(this.buildId)+this.buildId.length);e=(0,ie.s)(a.replace(/\.json$/,""))}if(this.nextConfig.i18n&&t){let{locales:a}=this.nextConfig.i18n;return(0,k.h)(e,a).pathname}return e}getOriginalAppPaths(e){if(this.hasAppDir){var t;return((t=this.appPathRoutes)==null?void 0:t[e])||null}return null}async renderPageComponent(e,t){var a;let{query:s,pathname:r}=e,i=this.getOriginalAppPaths(r),n=Array.isArray(i),l=r;n&&(l=i[0]);let o=await this.findPageComponents({pathname:l,query:s,params:e.renderOpts.params||{},isAppPath:n,appPaths:i,sriEnabled:!!((a=this.nextConfig.experimental.sri)!=null&&a.algorithm)});if(o)try{return await this.renderToResponseWithComponents(e,o)}catch(h){let p=h instanceof Y;if(!p||p&&t)throw h}return!1}async renderToResponse(e){let{res:t,query:a,pathname:s}=e,r=s,i=!!a._nextBubbleNoFallback;delete a._nextBubbleNoFallback;try{if(!(0,A.$)(r)){let n=await this.renderPageComponent(e,i);if(n!==!1)return n}if(this.dynamicRoutes)for(let n of this.dynamicRoutes){let l=n.match(s);if(!l)continue;r=n.page;let o=await this.renderPageComponent({...e,pathname:r,renderOpts:{...e.renderOpts,params:l}},i);if(o!==!1)return o}if(this.serverOptions.webServerConfig){e.pathname=this.serverOptions.webServerConfig.page;let n=await this.renderPageComponent(e,i);if(n!==!1)return n}}catch(n){let l=(0,X.S)(n);if(n instanceof O.At)throw console.error("Invariant: failed to load static page",JSON.stringify({page:r,url:e.req.url,matchedPath:e.req.headers["x-matched-path"],initUrl:(0,L.OX)(e.req,"__NEXT_INIT_URL"),didRewrite:(0,L.OX)(e.req,"_nextDidRewrite"),rewroteUrl:(0,L.OX)(e.req,"_nextRewroteUrl")},null,2)),l;if(l instanceof Y&&i)throw l;if(l instanceof O._9||l instanceof O.KM)return t.statusCode=400,await this.renderErrorToResponse(e,l);t.statusCode=500,await this.hasPage("/500")&&(e.query.__nextCustomErrorRender="1",await this.renderErrorToResponse(e,l),delete e.query.__nextCustomErrorRender);let o=l instanceof xe;if(!o){if(this.minimalMode,this.renderOpts.dev)throw(0,X.Z)(l)&&(l.page=r),l;this.logError((0,X.S)(l))}return await this.renderErrorToResponse(e,o?l.innerError:l)}return this.router.catchAllMiddleware[0]&&e.req.headers["x-nextjs-data"]&&(!t.statusCode||t.statusCode===200||t.statusCode===404)?(t.setHeader("x-nextjs-matched-path",`${a.__nextLocale?`/${a.__nextLocale}`:""}${s}`),t.statusCode=200,t.setHeader("content-type","application/json"),t.body("{}"),t.send(),null):(t.statusCode=404,this.renderErrorToResponse(e,null))}async renderToHTML(e,t,a,s={}){return this.getStaticHTML(r=>this.renderToResponse(r),{req:e,res:t,pathname:a,query:s})}async renderError(e,t,a,s,r={},i=!0){return i&&a.setHeader("Cache-Control","no-cache, no-store, max-age=0, must-revalidate"),this.pipe(async n=>{let l=await this.renderErrorToResponse(n,e);if(this.minimalMode&&a.statusCode===500)throw e;return l},{req:t,res:a,pathname:s,query:r})}customErrorNo404Warn=(0,O.gf)(()=>{Te(`You have added a custom /_error page without a custom /404 page. This prevents the 404 page from being auto statically optimized.
See here for info: https://nextjs.org/docs/messages/custom-error-no-custom-404`)});async renderErrorToResponse(e,t){let{res:a,query:s}=e;try{let r=null;a.statusCode===404&&await this.hasPage("/404")&&(r=await this.findPageComponents({pathname:"/404",query:s,params:{},isAppPath:!1}));let n=`/${a.statusCode}`;!e.query.__nextCustomErrorRender&&!r&&B.Er.includes(n)&&(n!=="/500"||!this.renderOpts.dev)&&(r=await this.findPageComponents({pathname:n,query:s,params:{},isAppPath:!1})),r||(r=await this.findPageComponents({pathname:"/_error",query:s,params:{},isAppPath:!1}),n="/_error");try{return await this.renderToResponseWithComponents({...e,pathname:n,renderOpts:{...e.renderOpts,err:t}},r)}catch(l){throw l instanceof Y?Error("invariant: failed to render error page"):l}}catch(r){let i=(0,X.S)(r),n=i instanceof xe;n||this.logError(i),a.statusCode=500;let l=await this.getFallbackErrorComponents();return l?this.renderToResponseWithComponents({...e,pathname:"/_error",renderOpts:{...e.renderOpts,err:n?i.innerError:i}},{query:s,components:l}):{type:"html",body:J.Z.fromStatic("Internal Server Error")}}}async renderErrorToHTML(e,t,a,s,r={}){return this.getStaticHTML(i=>this.renderErrorToResponse(i,e),{req:t,res:a,pathname:s,query:r})}async getFallbackErrorComponents(){return null}async render404(e,t,a,s=!0){let{pathname:r,query:i}=a||(0,E.parse)(e.url,!0);return this.nextConfig.i18n&&(i.__nextLocale=i.__nextLocale||this.nextConfig.i18n.defaultLocale,i.__nextDefaultLocale=i.__nextDefaultLocale||this.nextConfig.i18n.defaultLocale),t.statusCode=404,this.renderError(null,e,t,r,i,s)}}let Ve=d=>{let e=d.length,t=0,a=0,s=8997,r=0,i=33826,n=0,l=40164,o=0,h=52210;for(;t<e;)s^=d.charCodeAt(t++),a=435*s,r=435*i,n=435*l,o=435*h,n+=s<<8,o+=i<<8,r+=a>>>16,s=65535&a,n+=r>>>16,i=65535&r,h=o+(n>>>16)&65535,l=65535&n;return(15&h)*281474976710656+4294967296*l+65536*i+(s^h>>4)},Xe=(d,e=!1)=>(e?'W/"':'"')+Ve(d).toString(36)+d.length.toString(36)+'"';class Ge{constructor(e){this.pendingResponses=new Map,this.minimalMode=e}get(e,t,a){var s;let r=e?`${e}-${a.isManualRevalidate?"1":"0"}`:null,i=r?this.pendingResponses.get(r):null;if(i)return i;let n=()=>{},l=()=>{},o=new Promise((u,f)=>{n=u,l=f});r&&this.pendingResponses.set(r,o);let h=!1,p=u=>{r&&this.pendingResponses.set(r,Promise.resolve(u)),h||(h=!0,n(u))};return r&&this.minimalMode&&((s=this.previousCacheItem)==null?void 0:s.key)===r&&this.previousCacheItem.expiresAt>Date.now()?(p(this.previousCacheItem.entry),this.pendingResponses.delete(r),o):((async()=>{try{let u=await t(h,!1),f=u===null?null:{...u,isMiss:!0};a.isManualRevalidate||p(f),e&&u&&u.revalidate!==void 0?this.previousCacheItem={key:r||e,entry:u,expiresAt:Date.now()+1e3}:this.previousCacheItem=void 0,a.isManualRevalidate&&p(f)}catch(u){h?console.error(u):l(u)}finally{r&&this.pendingResponses.delete(r)}})(),o)}}function Qe(d,e=""){return d=d.replace(/\\/g,"/"),(d=e&&d.endsWith(e)?d.slice(0,-e.length):d).startsWith("/index/")&&!(0,A.$)(d)?d=d.slice(6):d==="/index"&&(d="/"),d}class Je extends ze{constructor(e){super(e),Object.assign(this.renderOpts,e.webServerConfig.extendRenderOpts)}handleCompression(){}getIncrementalCache(){return{}}getResponseCache(){return new Ge(this.minimalMode)}getCustomRoutes(){return{headers:[],rewrites:{fallback:[],afterFiles:[],beforeFiles:[]},redirects:[]}}async run(e,t,a){super.run(e,t,a)}async hasPage(e){return e===this.serverOptions.webServerConfig.page}getPublicDir(){return""}getBuildId(){return this.serverOptions.webServerConfig.extendRenderOpts.buildId}loadEnvConfig(){}getHasAppDir(){return this.serverOptions.webServerConfig.pagesType==="app"}getHasStaticDir(){return!1}async getFallback(){return""}getFontManifest(){}getPagesManifest(){return{[this.serverOptions.webServerConfig.page]:""}}getAppPathsManifest(){return{[this.serverOptions.webServerConfig.page]:""}}getFilesystemPaths(){return new Set}attachRequestMeta(e,t){(0,L.kL)(e,"__NEXT_INIT_QUERY",{...t.query})}getPrerenderManifest(){return{version:3,routes:{},dynamicRoutes:{},notFoundRoutes:[],preview:{previewModeId:"",previewModeSigningKey:"",previewModeEncryptionKey:""}}}getServerComponentManifest(){return this.serverOptions.webServerConfig.extendRenderOpts.serverComponentManifest}getServerCSSManifest(){return this.serverOptions.webServerConfig.extendRenderOpts.serverCSSManifest}getFontLoaderManifest(){return this.serverOptions.webServerConfig.extendRenderOpts.fontLoaderManifest}generateRoutes(){let e=[{match:(0,W.B)("/_next/data/:path*"),type:"route",name:"_next/data catchall",check:!0,fn:async(s,r,i,n)=>{if(!i.path||i.path[0]!==this.buildId)return await this.render404(s,r,n),{finished:!0};i.path.shift();let l=i.path[i.path.length-1];if(typeof l!="string"||!l.endsWith(".json"))return await this.render404(s,r,n),{finished:!0};let o=`/${i.path.join("/")}`;if(o=Qe(o,".json"),this.router.catchAllMiddleware[0]&&(this.nextConfig.trailingSlash&&!o.endsWith("/")&&(o+="/"),!this.nextConfig.trailingSlash&&o.length>1&&o.endsWith("/")&&(o=o.substring(0,o.length-1))),this.nextConfig.i18n){let{host:h}=s?.headers||{},p=h?.split(":")[0].toLowerCase(),u=(0,k.h)(o,this.nextConfig.i18n.locales),{defaultLocale:f}=(0,K.D)(this.nextConfig.i18n.domains,p)||{},c="";if(u.detectedLocale&&(o=u.pathname,c=u.detectedLocale),n.query.__nextLocale=c,n.query.__nextDefaultLocale=f||this.nextConfig.i18n.defaultLocale,!c&&!this.router.catchAllMiddleware[0])return n.query.__nextLocale=n.query.__nextDefaultLocale,await this.render404(s,r,n),{finished:!0}}return{pathname:o,query:{...n.query,__nextDataReq:"1"},finished:!1}}},{match:(0,W.B)("/_next/:path*"),type:"route",name:"_next catchall",fn:async(s,r,i,n)=>(await this.render404(s,r,n),{finished:!0})}],t={match:(0,W.B)("/:path*"),type:"route",matchesLocale:!0,name:"Catchall render",fn:async(s,r,i,n)=>{let{pathname:l,query:o}=n;if(!l)throw Error("pathname is undefined");if(l!==this.serverOptions.webServerConfig.page&&(l=this.serverOptions.webServerConfig.page,(0,A.$)(l))){let u=(0,ne.JV)(l);l=ve(l,o,u),ye(s,!0,Object.keys(u.routeKeys),!0,u)}if(l=(0,F.Q)(l),this.nextConfig.i18n){var h;let u=(0,k.h)(l,(h=this.nextConfig.i18n)==null?void 0:h.locales);u.detectedLocale&&(l=u.pathname,n.query.__nextLocale=u.detectedLocale)}let p=!!o._nextBubbleNoFallback;(0,pe.Q)(l)&&delete o._nextBubbleNoFallback;try{return await this.render(s,r,l,o,n,!0),{finished:!0}}catch(u){if(u instanceof Y&&p)return{finished:!1};throw u}}},{useFileSystemPublicRoutes:a}=this.nextConfig;return a&&(this.appPathRoutes=this.getAppPathRoutes(),this.dynamicRoutes=this.getDynamicRoutes()),{headers:[],fsRoutes:e,rewrites:{beforeFiles:[],afterFiles:[],fallback:[]},redirects:[],catchAllRoute:t,catchAllMiddleware:[],useFileSystemPublicRoutes:a,dynamicRoutes:this.dynamicRoutes,pageChecker:this.hasPage.bind(this),nextConfig:this.nextConfig}}async handleApiRequest(){return!1}async renderHTML(e,t,a,s,r){let{pagesRenderToHTML:i,appRenderToHTML:n}=this.serverOptions.webServerConfig,l=i||n;if(l)return await l({url:e.url,cookies:e.cookies,headers:e.headers},{},a,s,Object.assign(r,{disableOptimizedLoading:!0,runtime:"experimental-edge"}));throw Error("Invariant: curRenderToHTML is missing")}async sendRenderResult(e,t,a){t.setHeader("X-Edge-Runtime","1"),a.poweredByHeader&&a.type==="html"&&t.setHeader("X-Powered-By","Next.js");let s=a.result.contentType();if(t.getHeader("Content-Type")||t.setHeader("Content-Type",s||(a.type==="json"?"application/json":"text/html; charset=utf-8")),a.result.isDynamic()){let r=t.transformStream.writable.getWriter();a.result.pipe({write:i=>r.write(i),end:()=>r.close(),destroy:i=>r.abort(i),cork:()=>{},uncork:()=>{}})}else{let r=await a.result.toUnchunkedString();t.setHeader("Content-Length",String(Me(r))),a.generateEtags&&t.setHeader("ETag",Xe(r)),t.body(r)}t.send()}async runApi(){return!0}async findPageComponents({pathname:e,query:t,params:a}){let s=await this.serverOptions.webServerConfig.loadComponent(e);return s?{query:{...t||{},...a||{}},components:s}:null}}class Ke{constructor(e,t,a){this.method=e,this.url=t,this.body=a}get cookies(){return this._cookies?this._cookies:this._cookies=ce(this.headers)()}}class Ye{constructor(e){this.destination=e}redirect(e,t){return this.setHeader("Location",e),this.statusCode=t,t===B.fn&&this.setHeader("Refresh",`0;url=${e}`),this}}class Ze extends Ke{constructor(e){let t=new URL(e.url);for(let[a,s]of(super(e.method,t.href.slice(t.origin.length),e.clone().body),this.request=e,this.headers={},e.headers.entries()))this.headers[a]=s}async parseBody(e){throw Error("parseBody is not implemented in the web runtime")}}class et extends Ye{get sent(){return this._sent}constructor(e=new TransformStream){super(e.writable),this.transformStream=e,this.headers=new Headers,this.textBody=void 0,this._sent=!1,this.sendPromise=new Promise(t=>{this.sendResolve=t}),this.response=this.sendPromise.then(()=>new Response(this.textBody??this.transformStream.readable,{headers:this.headers,status:this.statusCode,statusText:this.statusMessage}))}setHeader(e,t){for(let a of(this.headers.delete(e),Array.isArray(t)?t:[t]))this.headers.append(e,a);return this}getHeaderValues(e){var t;return(t=this.getHeader(e))==null?void 0:t.split(",").map(a=>a.trimStart())}getHeader(e){return this.headers.get(e)??void 0}hasHeader(e){return this.headers.has(e)}appendHeader(e,t){return this.headers.append(e,t),this}body(e){return this.textBody=e,this}send(){var e;(e=this.sendResolve)==null||e.call(this),this._sent=!0}toResponse(){return this.response}}function tt({dev:d,page:e,appMod:t,pageMod:a,errorMod:s,error500Mod:r,pagesType:i,Document:n,buildManifest:l,reactLoadableManifest:o,appRenderToHTML:h,pagesRenderToHTML:p,serverComponentManifest:u,subresourceIntegrityManifest:f,serverCSSManifest:c,config:m,buildId:v,fontLoaderManifest:C}){let g=i==="app",x={dev:d,buildManifest:l,reactLoadableManifest:o,subresourceIntegrityManifest:f,fontLoaderManifest:C,Document:n,App:t?.default},y=new Je({dev:d,conf:m,minimalMode:!0,webServerConfig:{page:e,pagesType:i,extendRenderOpts:{buildId:v,runtime:te.Jp.experimentalEdge,supportsDynamicHTML:!0,disableOptimizedLoading:!0,serverComponentManifest:u,serverCSSManifest:c},appRenderToHTML:h,pagesRenderToHTML:p,loadComponent:async R=>g?null:R===e?{...x,Component:a.default,pageConfig:a.config||{},getStaticProps:a.getStaticProps,getServerSideProps:a.getServerSideProps,getStaticPaths:a.getStaticPaths,ComponentMod:a,pathname:R}:R==="/500"&&r?{...x,Component:r.default,pageConfig:r.config||{},getStaticProps:r.getStaticProps,getServerSideProps:r.getServerSideProps,getStaticPaths:r.getStaticPaths,ComponentMod:r,pathname:R}:R==="/_error"?{...x,Component:s.default,pageConfig:s.config||{},getStaticProps:s.getStaticProps,getServerSideProps:s.getServerSideProps,getStaticPaths:s.getStaticPaths,ComponentMod:s,pathname:R}:null}}),b=y.getRequestHandler();return async function(R){let q=new Ze(R),$=new et;return b(q,$),await $.toResponse()}}};export{nt as default};
