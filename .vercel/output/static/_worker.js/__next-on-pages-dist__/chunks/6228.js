var v=(k,S,f)=>{"use strict";f.d(S,{H4:()=>O,j8:()=>x});var _=f(872),A=f(4329),P=f(310),$=f(656);function C(e){let s="";for(let t=0;t<e.length;t++){let n=e.charCodeAt(t);(n>64&&n<91||n>96&&n<123)&&(s+=e[t])}return s}function R(e,s){return e.replace(RegExp(`:${(0,P.f)(s)}`,"g"),`__ESC_COLON_${s}`)}function E(e){return e.replace(/__ESC_COLON_/gi,":")}function O(e,s,t=[],n=[]){let r={},i=o=>{let l,u=o.key;switch(o.type){case"header":u=u.toLowerCase(),l=e.headers[u];break;case"cookie":l=e.cookies[o.key];break;case"query":l=s[u];break;case"host":{let{host:p}=e?.headers||{};l=p?.split(":")[0].toLowerCase()}}if(!o.value&&l)return r[C(u)]=l,!0;if(l){let p=RegExp(`^${o.value}$`),c=Array.isArray(l)?l.slice(-1)[0].match(p):l.match(p);if(c)return Array.isArray(c)&&(c.groups?Object.keys(c.groups).forEach(d=>{r[d]=c.groups[d]}):o.type==="host"&&c[0]&&(r.host=c[0])),!0}return!1};return!!(t.every(o=>i(o))&&!n.some(o=>i(o)))&&r}function g(e,s){if(!e.includes(":"))return e;for(let t of Object.keys(s))e.includes(`:${t}`)&&(e=e.replace(RegExp(`:${t}\\*`,"g"),`:${t}--ESCAPED_PARAM_ASTERISKS`).replace(RegExp(`:${t}\\?`,"g"),`:${t}--ESCAPED_PARAM_QUESTION`).replace(RegExp(`:${t}\\+`,"g"),`:${t}--ESCAPED_PARAM_PLUS`).replace(RegExp(`:${t}(?!\\w)`,"g"),`--ESCAPED_PARAM_COLON${t}`));return e=e.replace(/(:|\*|\?|\+|\(|\)|\{|\})/g,"\\$1").replace(/--ESCAPED_PARAM_PLUS/g,"+").replace(/--ESCAPED_PARAM_COLON/g,":").replace(/--ESCAPED_PARAM_QUESTION/g,"?").replace(/--ESCAPED_PARAM_ASTERISKS/g,"*"),(0,A.MY)(`/${e}`,{validate:!1})(s).slice(1)}function x(e){let s,t=Object.assign({},e.query);delete t.__nextLocale,delete t.__nextDefaultLocale,delete t.__nextDataReq;let n=e.destination;for(let a of Object.keys((0,_.Z)({},e.params,t)))n=R(n,a);let r=(0,$.e)(n),i=r.query,m=E(`${r.pathname}${r.hash||""}`),o=E(r.hostname||""),l=[],u=[];(0,A.Bo)(m,l),(0,A.Bo)(o,u);let p=[];l.forEach(a=>p.push(a.name)),u.forEach(a=>p.push(a.name));let c=(0,A.MY)(m,{validate:!1}),d=(0,A.MY)(o,{validate:!1});for(let[a,h]of Object.entries(i))Array.isArray(h)?i[a]=h.map(b=>g(E(b),e.params)):typeof h=="string"&&(i[a]=g(E(h),e.params));let y=Object.keys(e.params).filter(a=>a!=="nextInternalLocale");if(e.appendParamsToQuery&&!y.some(a=>p.includes(a)))for(let a of y)a in i||(i[a]=e.params[a]);try{s=c(e.params);let[a,h]=s.split("#");r.hostname=d(e.params),r.pathname=a,r.hash=`${h?"#":""}${h||""}`,delete r.search}catch(a){throw a.message.match(/Expected .*? to not repeat, but got an array/)?Error("To use a multi-match in the destination you must add `*` at the end of the param name to signify it should repeat. https://nextjs.org/docs/messages/invalid-multi-match"):a}return r.query=(0,_.Z)({},t,r.query),{newUrl:s,destQuery:i,parsedDestination:r}}};export{v as default};
