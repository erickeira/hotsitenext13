var Y=(M,h,c)=>{"use strict";function m(t){return t!=null}c.d(h,{QW:()=>S,yO:()=>H,h$:()=>d,YT:()=>o,YE:()=>v,pY:()=>p,PN:()=>x});var y=c(1190),g=c(1216);let q=globalThis.setTimeout;function o(t){return new TextEncoder().encode(t)}function f(t,e){return e.decode(t,{stream:!0})}function S(t){let{readable:e,writable:r}=new TransformStream,n=Promise.resolve();for(let u=0;u<t.length;++u)n=n.then(()=>t[u].pipeTo(r,{preventClose:u+1<t.length}));return e}function p(t){let{readable:e,writable:r}=new TransformStream,n=r.getWriter();return t.forEach(u=>n.write(o(u))),n.close(),e}async function x(t){let e=t.getReader(),r=new TextDecoder,n="";for(;;){let{done:u,value:l}=await e.read();if(u)return n;n+=f(l,r)}}function d(t=e=>e){let e="",r=null,n=l=>(r||(r=new Promise(a=>{setTimeout(async()=>{let i=await t(e);l.enqueue(o(i)),e="",r=null,a()},0)})),r),u=new TextDecoder;return new TransformStream({transform(l,a){e+=f(l,u),n(a)},flush(){if(r)return r}})}function b(t){return new TransformStream({async transform(e,r){let n=o(await t());r.enqueue(n),r.enqueue(e)}})}function v({ReactDOMServer:t,element:e,streamOptions:r}){return(0,y.Yz)().trace(g.k0.renderToReadableStream,async()=>t.renderToReadableStream(e,r))}function P(t){let e=!1,r=!1,n=new TextDecoder;return new TransformStream({async transform(u,l){if(r){l.enqueue(u);return}let a=await t();if(e)l.enqueue(o(a)),l.enqueue(u),r=!0;else{let i=f(u,n),s=i.indexOf("</head>");if(s!==-1){let T=i.slice(0,s)+a+i.slice(s);l.enqueue(o(T)),r=!0,e=!0}}e?q(()=>{r=!1}):l.enqueue(u)}})}function R(t){let e=!1,r=null;return new TransformStream({transform(n,u){u.enqueue(n),!e&&t&&(e=!0,r=new Promise(l=>{setTimeout(()=>{u.enqueue(o(t)),l()})}))},flush(n){if(r)return r;!e&&t&&(e=!0,n.enqueue(o(t)))}})}function _(t){let e=null;return new TransformStream({transform(r,n){if(n.enqueue(r),!e){let u=t.getReader();e=new Promise(l=>setTimeout(async()=>{try{for(;;){let{done:a,value:i}=await u.read();if(a)return l();n.enqueue(i)}}catch(a){n.error(a)}l()},0))}},flush(){if(e)return e}})}function D(t){return new TransformStream({flush(e){t&&e.enqueue(o(t))}})}function O(t="",e){let r=!1,n=!1,u=new TextDecoder;return new TransformStream({async transform(l,a){if(!r||!n){let i=f(l,u);!r&&i.includes("<html")&&(r=!0),!n&&i.includes("<body")&&(n=!0)}a.enqueue(l)},flush(l){let a=[r?null:"html",n?null:"body"].filter(m);a.length>0&&l.enqueue(o(`<script>self.__next_root_layout_missing_tags_error=${JSON.stringify({missingTags:a,assetPrefix:t??"",tree:e()})}<\/script>`))}})}async function H(t,{suffix:e,dataStream:r,generateStaticHTML:n,getServerInsertedHTML:u,serverInsertedHTMLToHead:l,validateRootLayout:a}){let i="</body></html>",s=e?e.split(i)[0]:null;return n&&await t.allReady,[d(),u&&!l?b(u):null,s!=null?R(s):null,r?_(r):null,s!=null?D(i):null,P(async()=>u&&l?await u():""),a?O(a.assetPrefix,a.getTree):null].filter(m).reduce((w,L)=>w.pipeThrough(L),t)}};export{Y as default};
